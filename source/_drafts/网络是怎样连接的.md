---
title: 网络是怎样连接的
tags:
---

# 梳理一个网络请求的基本流程







## 1. 第一步：解析 URL

## 2. 第二步：生成 HTTP 请求消息

## 3. 第三步：DNS 服务器查询域名对应的 IP 地址


## 4. You Should Know



### IP 有关知识











## 生成 HTTP 请求消息



### URL 省略文件名的情况

* http://www.lab.glasscom.com/dir/

以 "/" 结尾表示 /dir/ 后面本来有的文件名被省略了，但是如果没有文件名，那么服务器怎么知道访问哪个文件呢？一般的需要在服务器上设置文件名被省略时访问的默认文件，比如 index.html，此时访问的为 /dir/index.html 文件。

* http://www.lab.glasscom.com/

以 / 结尾，表示要访问一个名叫 / 文件夹，由于省略了文件名，所以同上一样，访问的文件为 /index.html 或其他指定的默认文件。

* http://www.lab.glasscom.com

没有路径名时，表明访问设置默认文件-——根目录下的 /index.html 或其他文件。

* http://www.lab.glasscom.com/adb

省略文件名的同时一般也会将 / 省略，所以此时的访问规则是：当 服务器中存在 adb 文件时，就将 adb 当做文件处理，如果服务器中存在 adb 的文件夹时，就将 adb 当做文件夹处理。




### HTTP 的基本思路


HTTP 协议定义了客户端和服务器之间交互的消息内容和步骤。

1. 首先客户端向服务器发送请求消息，请求消息包括“对什么”和“进行怎样的操作”两部分。

其中“对什么”的部分称为 URI，”进行怎样的操作“的部分称为请求的方法，比如 GET、POST等。HTTP 消息中除了 URL 和请求方法外，还可以包含表示附加信息的头部字段。在客户端向服务器发送请求时，会先发送头部字段，然后再发数据。

2. 服务器收到消息后，会对其中的信息进行解析，通过 URI 和方法来判断对什么进行怎样的操作，并根据解析出来的内容完成相应的工作，然后将结果放在响应消息中，发送回客户端，客户端会从响应消息中读取需要的数据，从而完成一次 HTTP 请求。

### 生成 HTTP 请求信息


在第一步中，对 URL 进行解析，这样浏览器就确定了服务器和请求的文件名，接下来就是根据这些信息生成 HTTP 请求信息。HTTP 协议规定了请求信息的格式，浏览器会严格按照要求生成 HTTP请求信息 。

HTTP 的请求信息的格式：

```
第一行：请求头
第二行：首部字段
最后：请求体
```

### 获得服务器响应


当响应的数据中含有其他资源 URI 时，浏览器会按照 URI 进行网络请求。

因为每条请求消息中只能写一个 URI，所以每次只能获取一个文件，如果需要获得多个文件，那么就需要针对每个文件单独发起一次网络请求。



## 向 DNS 服务器查询服务器的 IP 地址


在上一步中生成 HTTP 请求消息后，接下来就需要委托操作系统将消息发送给服务器。浏览器是不具备将消息发送给服务器的功能的，而在这一步之前需要