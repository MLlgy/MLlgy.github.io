---
title: '小程序学习笔记(五):模板 模块与缓存'
tags:
---

## 模块

模块可以大幅提供复用性与可维护性。

暴露模块：
```
// 向外暴露接口
module.exports={
    postList:postList
}
```
引入模块：
```
var dataObj=require('../data/data.js')
```

使用模块：

```
this.setData({
    postList:dataObj.postList
})
```


## 模板


小程序中存在模板技术支持对 wxml 的封装,WXML提供模板（template），可以在模板中定义代码片段，然后在不同的地方调用。

**定义模板**

在单独文件中定义模板内容：
<template name="name">
    ...
</template>

在单独 wxss 中定义样式，比如：
a.wxss
```
image{
    ...
}
```

**使用模板**

1. **引入 Wxml 模板**，在使用处引入相应的模板。
```
<import src="post-item/post-item-tpl.wxml"/>
```
2. **引入 CSS 模板**，将对应的 wxss 文件引入使用处对应的 wxss 文件中。
```
@import "../post/post-item/post-item-tpl.wxss";(可以使用绝对路径或相对路径)
```
3. 使用相应的模板。

```
<import src="post-item/post-item-tpl.wxml"/>
<view>
    <block wx:for="{{postList}}" wx:for-item="item" wx:for-index="idx" wx:key="idx">
        <template is="postItemTpl" data="{{item}}"/>
    </block>
</view>
```


**import 的作用域**

import 的作用域只在当前文件。

如果 C import B，B import A，那么 C 不能使用 A 中的模板。

**import 与 include 的区别**

include 可以实现和 import 相同的效果，但是使用起来有所不同。

* 使用 include 引用模板和 import 不同，不用要引入模板，然后在代码中使用。
* include 引用的代码中不能包含 template 标签。
  
include.wxml
```
<view>
    ....
</view>
```

b.wxml

```
<view>
    <include src="../a.wxl"/>
</view>
```



## 缓存

```
var dataObj = require('pages/data/data.js')
App({
    onLaunch: function () {
        // 使用 wx.setStorage 将初始数据存入小程序缓存中
        wx.setStorage({
        key: 'postList',
        data: dataObj.postList,
        success: function () {

        },
        fail: function () {

        },
        complete: function () {

        }
        });
    }
})
```

缓存不主动清除是不会失效的。

