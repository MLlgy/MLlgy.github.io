---
title: 单例的几种写法
date: 2019-03-13 11:37:05
tags:
---


### 一 饿汉式()


**方式一：**
```
public class Singleton{
    private final static Singleton INSTANCE = new Singleton();

    private Singleton(){}

    public static Singleton getInstance{
        return INSTANCE;
    }
}
```

**方式二:**
```
public class Singleton{
    private static Singleton INSTANCE ;

    static{
        INSTANCE = new Singleton();
    }

    private Singleton(){}

    public static Singleton getInstance{
        return INSTANCE;
    }
}
```

以上两种实现方法基本一致，均是利用 **类变量会在加载类时完成初始化** 这一特性，实现了 **线程安全**，在加载类的同时就会完成该类单例的创建，即使在多线程情况下访问到的也是同一个对象，当然实现了单例模式。

虽然饿汉式在类加载时就实现了类的单例，但是存在压根就用不到该单例的情况，此时就浪费了内存。

### 懒汉式

**方式一：**
```
public class Singleton{
    private static Singleton INSTANCE;

    private Singleton(){}

    /**
    * 静态方法虽然属于类，但是没有调用情况下不会执行。
    */
    public static Singleton getInstance{
        if(INSTANCE == null){
            INSTANCE = new Singleton(); 
        }
        return INSTANCE;
    }
}
```

懒汉式的 “懒” 就体现在:你用的话我就会初始化，你不用我我就不会初始化。

但是一个很明显的 Bug 是：在多线程情况下，有可能一个线程 A 进入了 `getInstance` 方法中但是未完成对象的初始化，但是此时另外的一个线程 B 进入该方法完成初始化初始化一个对象，A 之后重新执行生成一个对象，那么此刻就违背了单例模式的初衷。

**方式二：(改进)**






https://www.cnblogs.com/zhaoyan001/p/6365064.html